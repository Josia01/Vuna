<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Vuna Premium African Marketplace</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Add Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    
    <style>
        /* Your existing CSS styles remain the same */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        /* ... All your existing CSS styles ... */
        
    </style>
</head>
<body>
    <!-- Your existing HTML structure remains the same -->
    <!-- Top Promo Bar -->
    <div class="top-promo-bar">
        <!-- ... existing content ... -->
    </div>

    <!-- Main Header -->
    <header>
        <!-- ... existing content ... -->
    </header>

    <!-- Category Navigation -->
    <nav class="category-nav">
        <!-- ... existing content ... -->
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Auth Container -->
        <div class="auth-container">
            <!-- Auth Hero Section -->
            <div class="auth-hero">
                <!-- ... existing content ... -->
            </div>

            <!-- Auth Form Section -->
            <div class="auth-form-section">
                <!-- ... existing form content ... -->
                
                <!-- Social Login -->
                <div class="social-login">
                    <div class="social-login-title">
                        <i class="fas fa-external-link-alt"></i>
                        Continue with
                    </div>
                    <div class="social-login-buttons">
                        <button class="social-btn google" id="googleLogin">
                            <i class="fab fa-google"></i>
                            Google
                        </button>
                        <button class="social-btn facebook" id="facebookLogin">
                            <i class="fab fa-facebook-f"></i>
                            Facebook
                        </button>
                    </div>
                </div>

                <!-- ... rest of your form ... -->
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal" id="forgotPasswordModal">
        <!-- ... existing content ... -->
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <!-- ... existing content ... -->
    </div>

    <!-- Footer -->
    <footer>
        <!-- ... existing content ... -->
    </footer>

    <script>
        // ========== FIREBASE CONFIGURATION ==========
        // Replace with your Firebase project configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        let app;
        let auth;
        
        try {
            app = firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }

        // ========== FIREBASE AUTHENTICATION FUNCTIONS ==========
        
        // Handle Google Sign-In
        async function signInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                // Add scopes if needed
                provider.addScope('profile');
                provider.addScope('email');
                
                // Set custom parameters
                provider.setCustomParameters({
                    prompt: 'select_account'
                });
                
                // Show loading state
                showNotification('Connecting to Google...', 'info');
                const googleLoginBtn = document.getElementById('googleLogin');
                const originalContent = googleLoginBtn.innerHTML;
                googleLoginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                googleLoginBtn.disabled = true;
                
                // Sign in with popup
                const result = await auth.signInWithPopup(provider);
                
                // This gives you a Google Access Token
                const credential = firebase.auth.GoogleAuthProvider.credentialFromResult(result);
                const token = credential.accessToken;
                
                // The signed-in user info
                const user = result.user;
                
                console.log("Google sign-in successful:", user);
                showNotification(`Welcome ${user.displayName}!`, 'success');
                
                // Store user info in localStorage or sessionStorage
                localStorage.setItem('vuna_user', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName,
                    photoURL: user.photoURL,
                    userType: selectedUserType || 'buyer'
                }));
                
                // Reset button state
                googleLoginBtn.innerHTML = originalContent;
                googleLoginBtn.disabled = false;
                
                // Redirect based on user type
                handleAuthRedirect();
                
            } catch (error) {
                console.error("Google sign-in error:", error);
                
                // Reset button state
                const googleLoginBtn = document.getElementById('googleLogin');
                googleLoginBtn.innerHTML = '<i class="fab fa-google"></i> Google';
                googleLoginBtn.disabled = false;
                
                // Handle specific error cases
                if (error.code === 'auth/popup-blocked') {
                    showNotification('Popup was blocked by browser. Please allow popups for this site.', 'error');
                } else if (error.code === 'auth/popup-closed-by-user') {
                    showNotification('Sign-in was cancelled.', 'warning');
                } else if (error.code === 'auth/network-request-failed') {
                    showNotification('Network error. Please check your connection.', 'error');
                } else if (error.code === 'auth/unauthorized-domain') {
                    showNotification('This domain is not authorized for Google sign-in.', 'error');
                } else {
                    showNotification(`Sign-in failed: ${error.message}`, 'error');
                }
            }
        }

        // Handle Facebook Sign-In
        async function signInWithFacebook() {
            try {
                const provider = new firebase.auth.FacebookAuthProvider();
                // Add scopes if needed
                provider.addScope('email');
                provider.addScope('public_profile');
                
                // Show loading state
                showNotification('Connecting to Facebook...', 'info');
                const facebookLoginBtn = document.getElementById('facebookLogin');
                const originalContent = facebookLoginBtn.innerHTML;
                facebookLoginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                facebookLoginBtn.disabled = true;
                
                // Sign in with popup
                const result = await auth.signInWithPopup(provider);
                
                // The signed-in user info
                const user = result.user;
                
                console.log("Facebook sign-in successful:", user);
                showNotification(`Welcome ${user.displayName}!`, 'success');
                
                // Store user info
                localStorage.setItem('vuna_user', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName,
                    photoURL: user.photoURL,
                    userType: selectedUserType || 'buyer'
                }));
                
                // Reset button state
                facebookLoginBtn.innerHTML = originalContent;
                facebookLoginBtn.disabled = false;
                
                // Redirect based on user type
                handleAuthRedirect();
                
            } catch (error) {
                console.error("Facebook sign-in error:", error);
                
                // Reset button state
                const facebookLoginBtn = document.getElementById('facebookLogin');
                facebookLoginBtn.innerHTML = '<i class="fab fa-facebook-f"></i> Facebook';
                facebookLoginBtn.disabled = false;
                
                // Handle specific error cases
                if (error.code === 'auth/account-exists-with-different-credential') {
                    showNotification('An account already exists with the same email address but different sign-in credentials.', 'error');
                } else if (error.code === 'auth/popup-blocked') {
                    showNotification('Popup was blocked by browser. Please allow popups for this site.', 'error');
                } else if (error.code === 'auth/popup-closed-by-user') {
                    showNotification('Sign-in was cancelled.', 'warning');
                } else {
                    showNotification(`Facebook sign-in failed: ${error.message}`, 'error');
                }
            }
        }

        // Handle Email/Password Sign-Up
        async function signUpWithEmail(email, password, name, userType) {
            try {
                showNotification('Creating your account...', 'info');
                
                // Create user with email and password
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Update profile with display name
                await user.updateProfile({
                    displayName: name
                });
                
                // Send email verification (optional)
                await user.sendEmailVerification();
                
                console.log("Email sign-up successful:", user);
                
                // Store user info
                localStorage.setItem('vuna_user', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: name,
                    userType: userType,
                    emailVerified: user.emailVerified
                }));
                
                showNotification(`Welcome to Vuna, ${name}! Please check your email for verification.`, 'success');
                
                // Show success modal
                showSuccessModal();
                
                return user;
                
            } catch (error) {
                console.error("Email sign-up error:", error);
                
                if (error.code === 'auth/email-already-in-use') {
                    showNotification('This email is already registered. Please sign in instead.', 'error');
                } else if (error.code === 'auth/invalid-email') {
                    showNotification('Please enter a valid email address.', 'error');
                } else if (error.code === 'auth/weak-password') {
                    showNotification('Password should be at least 6 characters.', 'error');
                } else {
                    showNotification(`Sign-up failed: ${error.message}`, 'error');
                }
                
                throw error;
            }
        }

        // Handle Email/Password Sign-In
        async function signInWithEmail(email, password) {
            try {
                showNotification('Signing in...', 'info');
                
                // Sign in with email and password
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                console.log("Email sign-in successful:", user);
                
                // Check if email is verified (optional)
                if (!user.emailVerified) {
                    showNotification('Please verify your email address to access all features.', 'warning');
                }
                
                // Get user type from local storage or database (in a real app)
                const storedUser = JSON.parse(localStorage.getItem('vuna_user') || '{}');
                const userType = storedUser.userType || 'buyer';
                
                // Store updated user info
                localStorage.setItem('vuna_user', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: user.displayName || storedUser.displayName,
                    photoURL: user.photoURL,
                    userType: userType,
                    emailVerified: user.emailVerified
                }));
                
                showNotification(`Welcome back, ${user.displayName || user.email}!`, 'success');
                
                // Redirect based on user type
                handleAuthRedirect();
                
                return user;
                
            } catch (error) {
                console.error("Email sign-in error:", error);
                
                if (error.code === 'auth/user-not-found') {
                    showNotification('No account found with this email. Please sign up first.', 'error');
                } else if (error.code === 'auth/wrong-password') {
                    showNotification('Incorrect password. Please try again.', 'error');
                } else if (error.code === 'auth/invalid-email') {
                    showNotification('Please enter a valid email address.', 'error');
                } else if (error.code === 'auth/user-disabled') {
                    showNotification('This account has been disabled. Please contact support.', 'error');
                } else {
                    showNotification(`Sign-in failed: ${error.message}`, 'error');
                }
                
                throw error;
            }
        }

        // Handle Password Reset
        async function resetPassword(email) {
            try {
                showNotification('Sending reset email...', 'info');
                
                await auth.sendPasswordResetEmail(email);
                
                showNotification('Password reset email sent! Check your inbox.', 'success');
                closeAllModals();
                
            } catch (error) {
                console.error("Password reset error:", error);
                
                if (error.code === 'auth/user-not-found') {
                    showNotification('No account found with this email.', 'error');
                } else if (error.code === 'auth/invalid-email') {
                    showNotification('Please enter a valid email address.', 'error');
                } else {
                    showNotification(`Failed to send reset email: ${error.message}`, 'error');
                }
                
                throw error;
            }
        }

        // Handle Sign Out
        function signOut() {
            try {
                auth.signOut();
                localStorage.removeItem('vuna_user');
                showNotification('Signed out successfully.', 'success');
                
                // Redirect to login page
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
                
            } catch (error) {
                console.error("Sign out error:", error);
                showNotification('Error signing out. Please try again.', 'error');
            }
        }

        // Check if user is already signed in
        function checkAuthState() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    console.log("User is signed in:", user);
                    
                    // Update UI for signed-in user
                    const userActions = document.querySelector('.user-actions');
                    if (userActions) {
                        const accountLink = userActions.querySelector('a[href="account.html"]');
                        if (accountLink) {
                            accountLink.innerHTML = `
                                <i class="fas fa-user-circle action-icon"></i>
                                <span class="action-text">${user.displayName || 'Account'}</span>
                            `;
                        }
                    }
                    
                    // If already on login page and signed in, redirect to home
                    if (window.location.pathname.includes('login.html')) {
                        setTimeout(() => {
                            handleAuthRedirect();
                        }, 1000);
                    }
                } else {
                    // User is signed out
                    console.log("User is signed out");
                }
            });
        }

        // Handle redirect after authentication
        function handleAuthRedirect() {
            // Get user type from local storage
            const userData = JSON.parse(localStorage.getItem('vuna_user') || '{}');
            const userType = userData.userType || 'buyer';
            
            if (userType === 'seller') {
                // Redirect to seller dashboard
                setTimeout(() => {
                    window.location.href = 'seller-dashboard.html';
                }, 1500);
            } else {
                // Redirect to buyer account page or home
                setTimeout(() => {
                    window.location.href = 'account.html';
                }, 1500);
            }
        }

        // ========== MODIFIED EVENT LISTENERS ==========
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Firebase auth state listener
            checkAuthState();
            
            // Create mobile overlay element
            const mobileOverlay = document.createElement('div');
            mobileOverlay.className = 'mobile-overlay';
            document.body.appendChild(mobileOverlay);
            
            // DOM Elements
            const authForm = document.getElementById('authForm');
            const authTitle = document.getElementById('authTitle');
            const authSubtitle = document.getElementById('authSubtitle');
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const toggleLink = document.getElementById('toggleLink');
            const toggleText = document.getElementById('toggleText');
            const nameField = document.getElementById('nameField');
            const confirmPasswordField = document.getElementById('confirmPasswordField');
            const rememberMeField = document.getElementById('rememberMeField');
            const forgotPasswordLink = document.getElementById('forgotPasswordLink');
            const userTypeOptions = document.querySelectorAll('.user-type-option');
            const userTypeInput = document.getElementById('userType');
            const googleLoginBtn = document.getElementById('googleLogin');
            const facebookLoginBtn = document.getElementById('facebookLogin');
            const togglePasswordBtn = document.getElementById('togglePassword');
            const toggleConfirmPasswordBtn = document.getElementById('toggleConfirmPassword');
            const forgotPasswordModal = document.getElementById('forgotPasswordModal');
            const resetPasswordForm = document.getElementById('resetPasswordForm');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const successModal = document.getElementById('successModal');
            const successTitle = document.getElementById('successTitle');
            const successMessage = document.getElementById('successMessage');
            const continueBtn = document.getElementById('continueBtn');
            
            // Mobile menu elements
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const categoryNav = document.querySelector('.category-nav');
            const mobileSearchInput = document.getElementById('mobileSearchInput');
            const mobileSearchButton = document.getElementById('mobileSearchButton');
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            const categoryLinks = document.querySelectorAll('.category-link');
            
            // State variables
            let isSignUp = false;
            let selectedUserType = 'buyer';
            let isPasswordVisible = false;
            let isConfirmPasswordVisible = false;
            
            // Initialize
            function initialize() {
                setupEventListeners();
                selectUserType('buyer');
                
                // Check if user is already logged in
                const currentUser = auth.currentUser;
                if (currentUser) {
                    showNotification(`Welcome back, ${currentUser.displayName || currentUser.email}!`, 'info');
                    setTimeout(() => {
                        handleAuthRedirect();
                    }, 2000);
                }
            }
            
            // Setup event listeners
            function setupEventListeners() {
                // Mobile menu toggle
                if (mobileMenuBtn && categoryNav) {
                    mobileMenuBtn.addEventListener('click', function() {
                        const isActive = categoryNav.classList.contains('active');
                        
                        if (isActive) {
                            categoryNav.classList.remove('active');
                            mobileOverlay.classList.remove('active');
                            mobileMenuBtn.classList.remove('active');
                            document.body.classList.remove('menu-open');
                            mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                        } else {
                            categoryNav.classList.add('active');
                            mobileOverlay.classList.add('active');
                            mobileMenuBtn.classList.add('active');
                            document.body.classList.add('menu-open');
                            mobileMenuBtn.innerHTML = '<i class="fas fa-times"></i>';
                        }
                    });
                    
                    // Close menu when clicking overlay
                    mobileOverlay.addEventListener('click', function() {
                        categoryNav.classList.remove('active');
                        mobileOverlay.classList.remove('active');
                        mobileMenuBtn.classList.remove('active');
                        document.body.classList.remove('menu-open');
                        mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    });
                    
                    // Close menu when clicking a category link
                    categoryLinks.forEach(link => {
                        link.addEventListener('click', function() {
                            categoryNav.classList.remove('active');
                            mobileOverlay.classList.remove('active');
                            mobileMenuBtn.classList.remove('active');
                            document.body.classList.remove('menu-open');
                            mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                        });
                    });
                }

                // Mobile search functionality
                if (mobileSearchButton && mobileSearchInput) {
                    mobileSearchButton.addEventListener('click', function() {
                        performMobileSearch();
                    });
                    
                    mobileSearchInput.addEventListener('keyup', function(event) {
                        if (event.key === 'Enter') {
                            performMobileSearch();
                        }
                    });
                    
                    function performMobileSearch() {
                        const query = mobileSearchInput.value.trim();
                        
                        if (query === '') {
                            showNotification('Please enter a search term', 'warning');
                            mobileSearchInput.focus();
                            return;
                        }
                        
                        // Add loading animation
                        const originalIcon = mobileSearchButton.innerHTML;
                        mobileSearchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                        mobileSearchButton.disabled = true;
                        
                        setTimeout(() => {
                            window.location.href = `search.html?q=${encodeURIComponent(query)}`;
                        }, 500);
                    }
                }

                // Desktop search functionality
                if (searchButton && searchInput) {
                    searchButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        performSearch();
                    });
                    
                    searchInput.addEventListener('keyup', function(event) {
                        if (event.key === 'Enter') {
                            performSearch();
                        }
                    });
                    
                    function performSearch() {
                        const query = searchInput.value.trim();
                        
                        if (query === '') {
                            showNotification('Please enter a search term', 'warning');
                            searchInput.focus();
                            return;
                        }
                        
                        // Add loading animation
                        const originalIcon = searchButton.innerHTML;
                        searchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                        searchButton.disabled = true;
                        
                        setTimeout(() => {
                            window.location.href = `search.html?q=${encodeURIComponent(query)}`;
                            searchButton.innerHTML = originalIcon;
                            searchButton.disabled = false;
                        }, 500);
                    }
                }

                // Category links functionality
                categoryLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const category = this.dataset.category;
                        window.location.href = `search.html?category=${encodeURIComponent(category)}`;
                    });
                });

                // Toggle between sign in/sign up
                toggleLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    toggleAuthMode();
                });
                
                // User type selection
                userTypeOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        const type = this.dataset.type;
                        selectUserType(type);
                    });
                });
                
                // Form submission - MODIFIED for Firebase
                authForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    // Validate form
                    if (!validateForm()) {
                        return;
                    }
                    
                    // Show loading state
                    submitBtn.disabled = true;
                    loadingSpinner.style.display = 'inline-block';
                    submitText.textContent = isSignUp ? 'Creating Account...' : 'Signing In...';
                    
                    const email = document.getElementById('email').value;
                    const password = document.getElementById('password').value;
                    
                    try {
                        if (isSignUp) {
                            const name = document.getElementById('name').value;
                            await signUpWithEmail(email, password, name, selectedUserType);
                        } else {
                            await signInWithEmail(email, password);
                        }
                    } catch (error) {
                        // Error is already handled in the functions
                    } finally {
                        // Hide loading state
                        submitBtn.disabled = false;
                        loadingSpinner.style.display = 'none';
                        submitText.textContent = isSignUp ? 'Create Account' : 'Sign In';
                    }
                });
                
                // Social login buttons - MODIFIED for Firebase
                googleLoginBtn.addEventListener('click', signInWithGoogle);
                facebookLoginBtn.addEventListener('click', signInWithFacebook);
                
                // Password visibility toggle
                togglePasswordBtn.addEventListener('click', function() {
                    togglePasswordVisibility('password', togglePasswordBtn);
                });
                
                toggleConfirmPasswordBtn.addEventListener('click', function() {
                    togglePasswordVisibility('confirmPassword', toggleConfirmPasswordBtn);
                });
                
                // Forgot password
                forgotPasswordLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    openForgotPasswordModal();
                });
                
                // Modal close button
                closeModalBtn.addEventListener('click', closeAllModals);
                
                // Reset password form - MODIFIED for Firebase
                resetPasswordForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const email = document.getElementById('resetEmail').value;
                    
                    if (!email || !isValidEmail(email)) {
                        showNotification('Please enter a valid email address', 'error');
                        return;
                    }
                    
                    // Show loading
                    const submitBtn = resetPasswordForm.querySelector('.submit-btn');
                    const originalText = submitBtn.textContent;
                    submitBtn.textContent = 'Sending...';
                    submitBtn.disabled = true;
                    
                    try {
                        await resetPassword(email);
                    } catch (error) {
                        // Error is already handled in the function
                    } finally {
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                    }
                });
                
                // Continue button
                continueBtn.addEventListener('click', function() {
                    handleAuthRedirect();
                });
                
                // Close modal on outside click
                document.addEventListener('click', function(e) {
                    if (e.target.classList.contains('modal')) {
                        closeAllModals();
                    }
                });
            }
            
            // Toggle between sign in and sign up
            function toggleAuthMode() {
                isSignUp = !isSignUp;
                
                if (isSignUp) {
                    authTitle.textContent = 'Create Your Account';
                    authSubtitle.textContent = selectedUserType === 'seller' 
                        ? 'Start selling your African products to the world' 
                        : 'Join Africa\'s premium marketplace';
                    submitText.textContent = 'Create Account';
                    toggleText.textContent = 'Already have an account?';
                    toggleLink.textContent = 'Sign in';
                    nameField.style.display = 'block';
                    confirmPasswordField.style.display = 'block';
                    rememberMeField.style.display = 'none';
                    forgotPasswordLink.style.display = 'none';
                    
                    // Show user type selection
                    document.getElementById('userTypeSection').style.display = 'block';
                } else {
                    authTitle.textContent = 'Sign In to Vuna';
                    authSubtitle.textContent = 'Access your account to continue your African marketplace journey';
                    submitText.textContent = 'Sign In';
                    toggleText.textContent = 'Don\'t have an account?';
                    toggleLink.textContent = 'Sign up';
                    nameField.style.display = 'none';
                    confirmPasswordField.style.display = 'none';
                    rememberMeField.style.display = 'flex';
                    forgotPasswordLink.style.display = 'block';
                    
                    // Hide user type selection for sign in
                    if (selectedUserType === 'buyer') {
                        document.getElementById('userTypeSection').style.display = 'none';
                    }
                }
                
                // Clear form
                authForm.reset();
            }
            
            // Select user type
            function selectUserType(type) {
                selectedUserType = type;
                userTypeInput.value = type;
                
                // Update UI
                userTypeOptions.forEach(option => {
                    if (option.dataset.type === type) {
                        option.classList.add('selected');
                    } else {
                        option.classList.remove('selected');
                    }
                });
                
                // Update subtitles based on user type
                if (isSignUp) {
                    if (type === 'seller') {
                        authSubtitle.textContent = 'Start selling your African products to the world';
                    } else {
                        authSubtitle.textContent = 'Join Africa\'s premium marketplace';
                    }
                }
            }
            
            // Toggle password visibility
            function togglePasswordVisibility(fieldId, button) {
                const field = document.getElementById(fieldId);
                
                if (fieldId === 'password') {
                    isPasswordVisible = !isPasswordVisible;
                    field.type = isPasswordVisible ? 'text' : 'password';
                    button.innerHTML = isPasswordVisible ? '<i class="fas fa-eye-slash"></i>' : '<i class="fas fa-eye"></i>';
                } else {
                    isConfirmPasswordVisible = !isConfirmPasswordVisible;
                    field.type = isConfirmPasswordVisible ? 'text' : 'password';
                    button.innerHTML = isConfirmPasswordVisible ? '<i class="fas fa-eye-slash"></i>' : '<i class="fas fa-eye"></i>';
                }
            }
            
            // Validate form
            function validateForm() {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const name = isSignUp ? document.getElementById('name').value : '';
                const confirmPassword = isSignUp ? document.getElementById('confirmPassword').value : '';
                
                // Clear previous errors
                clearErrors();
                
                let isValid = true;
                
                // Email validation
                if (!email || !isValidEmail(email)) {
                    showError('email', 'Please enter a valid email address');
                    isValid = false;
                }
                
                // Password validation
                if (!password) {
                    showError('password', 'Please enter your password');
                    isValid = false;
                } else if (isSignUp && password.length < 6) {
                    showError('password', 'Password must be at least 6 characters');
                    isValid = false;
                }
                
                // Name validation (for sign up)
                if (isSignUp && !name) {
                    showError('name', 'Please enter your full name');
                    isValid = false;
                }
                
                // Confirm password validation (for sign up)
                if (isSignUp && password !== confirmPassword) {
                    showError('confirmPassword', 'Passwords do not match');
                    isValid = false;
                }
                
                return isValid;
            }
            
            // Validate email format
            function isValidEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
            
            // Show error for a field
            function showError(fieldId, message) {
                const field = document.getElementById(fieldId);
                const formGroup = field.closest('.form-group');
                
                // Add error class to input
                field.classList.add('error');
                
                // Create error message element
                const errorElement = document.createElement('div');
                errorElement.className = 'error-message';
                errorElement.style.cssText = 'color: var(--sale); font-size: 0.85rem; margin-top: 8px;';
                errorElement.textContent = message;
                
                // Add error message to form group
                formGroup.appendChild(errorElement);
            }
            
            // Clear all errors
            function clearErrors() {
                // Remove error classes
                document.querySelectorAll('input.error').forEach(input => {
                    input.classList.remove('error');
                });
                
                // Remove error messages
                document.querySelectorAll('.error-message').forEach(error => {
                    error.remove();
                });
            }
            
            // Open forgot password modal
            function openForgotPasswordModal() {
                forgotPasswordModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Close all modals
            function closeAllModals() {
                forgotPasswordModal.classList.remove('active');
                successModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
            
            // Show success modal
            function showSuccessModal() {
                if (selectedUserType === 'seller') {
                    successTitle.textContent = 'Welcome, Seller!';
                    successMessage.textContent = 'Your seller account has been created. Get ready to showcase your African products to the world.';
                    continueBtn.textContent = 'Go to Seller Dashboard';
                } else {
                    successTitle.textContent = 'Welcome to Vuna!';
                    successMessage.textContent = 'Your account has been created successfully. Start exploring premium African products.';
                    continueBtn.textContent = 'Continue to Dashboard';
                }
                
                successModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Show notification
            function showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                
                // Set colors based on type
                let bgColor, icon;
                switch(type) {
                    case 'success':
                        bgColor = 'var(--success)';
                        icon = 'fas fa-check-circle';
                        break;
                    case 'warning':
                        bgColor = 'var(--accent-dark)';
                        icon = 'fas fa-exclamation-triangle';
                        break;
                    case 'error':
                        bgColor = 'var(--sale)';
                        icon = 'fas fa-times-circle';
                        break;
                    default:
                        bgColor = 'var(--primary)';
                        icon = 'fas fa-info-circle';
                }
                
                notification.style.cssText = `
                    position: fixed;
                    bottom: 30px;
                    right: 30px;
                    background: ${bgColor};
                    color: white;
                    padding: 18px 24px;
                    border-radius: 16px;
                    box-shadow: 0 12px 40px rgba(0,0,0,0.25);
                    z-index: 9999;
                    animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                    display: flex;
                    align-items: center;
                    gap: 12px;
                    max-width: 400px;
                    backdrop-filter: blur(10px);
                    border: 1px solid rgba(255, 255, 255, 0.2);
                `;
                
                // Add animation
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%) translateY(20px); opacity: 0; }
                        to { transform: translateX(0) translateY(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0) translateY(0); opacity: 1; }
                        to { transform: translateX(100%) translateY(20px); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
                
                notification.innerHTML = `
                    <i class="${icon}" style="font-size: 1.4rem;"></i>
                    <span>${message}</span>
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 4 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.4s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 400);
                }, 4000);
            }
            
            // Initialize the page
            initialize();
        });
    </script>
</body>
</html>
